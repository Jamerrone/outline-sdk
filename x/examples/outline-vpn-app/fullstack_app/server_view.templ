package fullstack_app

templ serverView() {
  <html>
    <head>
      <style>
        body, main, main * {
          all: initial;
          font-family: system-ui;
          box-sizing: border-box;
        }
        main {
          width: 100vw;
          min-height: 100svh;
          display: flex;
          flex-direction: column;
        }

        header {
          width: 100%;
          background-color: hsl(170, 45%, 15%);
          padding: 1rem 0;
          flex-shrink: 0;
        }

        h1 {
          display: block;
          color: white;
          font-size: 2rem;
          text-align: center;
          width: 100%;
        }

        article {
          background-color: hsl(170, 3%, 95%);
          flex-grow: 1;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        button {
          cursor: pointer;
          border: 0.5rem dashed hsl(170, 5%, 45%);
          background-color: hsl(170, 8%, 85%);
          width: clamp(240px, 33vw, 480px);
          height: clamp(240px, 33vw, 480px);
          border-radius: 100%;
          color: hsl(170, 5%, 45%);
          text-align: center;
          font-size: 1.5rem;
          font-weight: bold;
          transition-duration: 1000ms;
          transition-property: background-color, color, border;
          transition-timing-function: ease;
        }

        button.connected {
          border-style: solid;
          border-color: hsl(170, 40%, 55%);
          background: hsl(170, 40%, 55%);
          color: hsl(170, 8%, 85%);
        }

        footer {
          flex-shrink: 0;
          background-color: hsl(170, 15%, 85%);
          border-top: 1px solid hsl(170, 5%, 45%);
          padding: 1rem;
          display: flex;
          align-items: center;
        }

        h2, h3 {
          display: block;
        }

        h2 {
          font-weight: bold;
        }

        .info {
          flex-grow: 1;
        }

        .caret {
          flex-shrink: 0;
          font-size: 1,5rem;
          padding: 0 0.5rem;
        }
      </style>
      <script src="https://unpkg.com/htmx.org@1.9.10" integrity="sha384-D1Kt99CQMDuVetoL1lrYwg5t+9QdHe7NLX/SoJYkXDFfX37iInKRy5xLSi8nO7UC" crossorigin="anonymous"></script>
    </head>
    <body>
      <main>
        <header><h1>outline</h1></header>
        <article>
          <section>
            @connectionButton()
          </section>
        </article>
        <footer>
          <div class="info">
          <h2>Server Name</h2>
          <h3>127.0.0.1:443</h3>
          </div>
          <div class="caret">
            â–¼
          </div>
        </footer>
      </main>

      <script type="text/javascript">
				let conn = new WebSocket("ws://" + document.location.host + "/__reload__");  
				conn.onclose = function (evt) {  
					console.log("Connection Closed")  
					setTimeout(() => location.reload(), 5000);  
				};
		  </script>

    </body>
  </html>
}

templ connectionButton() {
  <button id="connection-button" hx-get="/connection" hx-swap="outerHTML">connect</button>
}

templ disconnectionButton() {
  <button id="connection-button" hx-get="/disconnection" hx-swap="outerHTML" class="connected">disconnect</button>
}
